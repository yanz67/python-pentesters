#!/usr/bin/env python3

import queue
import threading
from ftplib import FTP


def ftp_list_root(ftp_hostname):
    print(f'connection to: {ftp_hostname}')
    ftp = FTP(host=ftp_hostname)
    ftp.login()
    ftp.retrlines('LIST')


class WorkerThread(threading.Thread):
    def __init__(self, worker_queue):
        threading.Thread.__init__(self)
        self.queue = worker_queue

    def run(self):
        print("In WorkerThread")
        while True:
            ftp_hostname = self.queue.get()
            print(f'===> {ftp_hostname}')
            ftp_list_root(ftp_hostname)
            self.queue.task_done()


queue = queue.Queue()
# Thanks to SPSE-445 for the list :)
ftp_hosts_list = ['ftp.x.org', 'ftp4.FreeBSD.org', 'ftp.ncsa.uiuc.edu', 'ftp.mozilla.org', 'ftp.crans.org']

for i in range(5):
    print(f'Creating WorkThread: {i}')
    worker = WorkerThread(queue)
    worker.setDaemon(True)
    worker.start()
    print(f'WorkerThread {i} Created!')

for j in range(len(ftp_hosts_list)):
    queue.put(ftp_hosts_list[j])

queue.join()

print("All tasks over!")
