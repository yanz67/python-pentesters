#!/usr/bin/env python3

import threading
import queue
import time


class WorkerThread(threading.Thread):
    def __init__(self, worker_queue):
        threading.Thread.__init__(self)
        self.queue = worker_queue

    def run(self):
        print("In WorkerThread")
        while True:
            task_info = self.queue.get()
            print(f'Ordered to sleep for {task_info["task"]} seconds')
            time.sleep(task_info["task"])
            print(f'Finished sleeping for {task_info["task"]} seconds')
            self.queue.task_done()


queue = queue.Queue()

for i in range(10):
    print(f'Creating WorkThread: {i}')
    worker = WorkerThread(queue)
    worker.setDaemon(True)
    worker.start()
    print(f'WorkerThread {i} Created!')

for j in range(10):
    queue.put({'task': i})

queue.join()

print("All tasks over!")
