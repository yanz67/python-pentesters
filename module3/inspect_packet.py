#!/usr/bin/env python3

import socket
import struct
import binascii

if __name__ == '__main__':
    # socket.PF_PACKET is not available on OSX
    raw_socket = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)
    pkt = raw_socket.recvfrom(256)
    print(pkt)
    ethernet_header = pkt[0][0:14]
    eth_hdr = struct.unpack("!6s6s2s", ethernet_header)
    print(eth_hdr)
    print(f'{binascii.hexlify(eth_hdr[0])} -- {binascii.hexlify(eth_hdr[1])} -- {binascii.hexlify(eth_hdr[2])}')

